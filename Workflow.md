## Окружение

Для удобства работы над проектом используются инструменты из **Node.js** и **npm**. Все необходимые настройки произведены. Убедитесь, что на рабочем компьютере установлен актуальный LTS релиз Node.js**. Актуальная версия **Node.js\*\* указана в файле `package.json` в поле `node`. Затем, в терминале, перейдите в директорию с проектом и _единожды_ запустите команду:
```
npm install
```
Команда запустит процесс установки зависимостей проекта из **npm**.

### Переменные окружения

Пример заполнения приведен в файле [.env.example](.env.example)

| Параметр             | Значение         | Комментарий                                              |
| -------------------- | ---------------- | -------------------------------------------------------- |
| **PORT**             | _5000_           | порт сервера                                             |
| **SALT**             | _SecreT~S-A-L-T_ | произвольная строка (соль)                               |
| **DB_USER**          | _admin_          | логин базы данных                                        |
| **DB_PASSWORD**      | _passW0rd_       | пароль базы данных                                       |
| **DB_PORT**          | _27017_          | порт базы данных                                         |
| **DB_NAME**          | _six-cities_     | название базы данных                                     |
| **DB_HOST**          | _127.0.0.1_      | хост базы данных                                         |
| **UPLOAD_DIRECTORY** | _upload_         | директория для загрузки аватарок                         |
| **JWT_SECRET**       | _Secret-Key_     | ключ для JWT                                             |
| **HOST**             | _localhost_      | хост базы данных                                         |
| **STATIC_DIRECTORY** | _static_         | директория для файлов по умолчанию (аватар по умолчанию) |


### Сценарии

В `package.json` предопределено несколько сценариев.

#### Скомпилировать проект
```
npm run compile
```
Создаст директорию `dist` и скомпилирует проект.

#### Удалить скомпилированный проект
```
npm run clean
```
Удаляет директорию `dist`. Используется перед компиляцией.

#### Собрать проект
```
npm run build
```
Выполняет сборку проекта: удаляет ранее скомпилированный проект и компилирует заново.

#### Проверить линтером
```
npm run lint
```
Запуск проверки проекта статическим анализатором кода **ESLint**.

Линтер проверяет файлы только внутри директории `src`.

**Обратите внимание**, при запуске данной команды, ошибки выводятся в терминал.

#### Запустить ts-модуль без компиляции
```
npm run ts -- <Путь к модулю с ts-кодом>
```
Пакет `ts-node` позволяет выполнить TS-код в Node.js без предварительной компиляции. Используется только на этапе разработки.

#### Запустить моковый сервер
```
npm run mock:server
```
Запускает JSON-сервер, необходимый  для генерации моковых данных.

#### Запустить проект
```
npm start
```
В процессе запуска проекта будет выполнен процесс «Сборки проекта» и запуска результирующего кода.

**Запустить проект в режиме разработки**
```
npm start:dev
```
В процессе запуска проекта будет выполнен процесс «Сборки проекта» и запуска результирующего кода в режиме разработки.

#### Скомпилировать и запустить CLI приложение
```
nmp run CLI -- [параметры] 
```

Выполняет сборку проекта, устанавливает аттрибут исполняемого файла `./dist/main.cli.js` и запускает CLI-приложение c указанными параметрами.

# Запуск проекта

1. Установить пакеты
```
npm i
```
2. Создать файл `.env` с переменными окружения (можно скопировать из примера `.env.example`)
```
cp .env.example .env
```
3. Запустить моковый сервер
```
npm run mock:server
```
4. Сгенерировать тестовые данные
```
npm run CLI -- --generate 10 ./mocks/users.tsv ./mocks/offers.tsv http://localhost:3123/api
```
5. Запустить докер 
```
docker compose -p "six-cities" up -d
```
6. Заполнить базу данных сгенерированными значениями
```
npm run CLI -- --import ./mocks/users.tsv ./mocks/offers.tsv admin passW0rd localhost six-cities SecreT-S-A-L-T
```
7. Запустить сервер 
```
npm run start
```
8. Инструкция по запуску фронтенда - [Readme.md](frontend/Readme.md)

## Структура проекта

### Директория `src`
Исходный код проекта: компоненты, модули и так далее. Структура директории `src` может быть произвольной.

### Директория `static`
Статичные ресурсы

### Директория `upload`
Директория для загрузки аватарок пользователей

### Директория `frontend`
Исходный код фронтенда

### Файл `Readme.md`
Инструкции по работе с учебным репозиторием.

### Файл `Contributing.md`
Советы и инструкции по внесению изменений в учебный репозиторий.

### Остальное
Все остальные файлы в проекте являются служебными. Пожалуйста, не удаляйте и не изменяйте их самовольно. Только если того требует задание или наставник.

